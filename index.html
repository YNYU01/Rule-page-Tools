<!DOCTYPE html>
  <html lang="en">
  <head>
      <script src="https://html2canvas.hertzen.com/dist/html2canvas.min.js"></script>
      <meta charset="UTF-8">
      <title>Rule-page Tools</title>
      <link rel="stylesheet" type="text/css" href="style.css">
      <style>
      :root{
           --color5:hsl(0,0%,39%);
           --color1:hsl(0,0%,30%);
           --color2:hsl(0,0%,42%);
           --color3:hsl(0,0%,100%);
           --color4:hsl(0,0%,65%);
           }

      .color-5{
        background:var(--color5)
      }

      .color-1{
        background:var(--color1)
      }

      .color-2{
        background:var(--color2)
      }

      .color-3{
        background:var(--color3)
      }

      .color-4{
        background:var(--color4)
      }

      .color-box{
        width: 40px;
        height: 30px;
        border: 1px solid black;
        border-radius: 4px;
      }
      .text-box{
        width: 40px;
        height: 10px;
      }

      .text-1{
        font-size: 12px;
        text-align: center;
      }

      .bg-box{
        width: 375px; height: 650px;
        background:var(--color5)
      }

      #bg-img{
        background-image: url('https://raw.githubusercontent.com/YNYU01/Mini-Act-Tools/main/img/bg_%E8%A7%84%E5%88%99%E9%A1%B5.png');
        background-repeat: no-repeat;
        background-size: contain;
        background-position: top;
        overflow: hidden;
      }

      .button {
        text-align: center;
        line-height: 8px;
        width:80px; 
        height:26px; 
        border-radius: 4px;
        background-color: rgb(92, 141, 190);
        color: white;
        padding: 10px 20px;
        border: none;
        cursor: pointer;
      }

      .button:hover {
        background-color: rgb(63, 113, 164);
      }

      .button2 {
        text-align: center;
        line-height: 8px;
        width:80px; 
        height:26px; 
        border-radius: 4px;
        background-color: rgb(218, 218, 218);
        color: white;
        padding: 10px 20px;
        border: none;
        cursor: pointer;
      }

      .button2:hover {
        background-color: rgb(120, 120, 120);
      }
      
      </style>
  </head>
  <body>
      <div style="width: 400px; height: 850px;flex-direction: column; left:8px; position: relative; background-color: #eee; border-radius: 10px;">

        <p>
          <div style=" width: 375px; height: 100px;position: relative; top: 10px; text-align: center; font-size: 24px; font-family: Source Han Sans CN; font-weight: 700; color:#444 " > 规则页模板1.0
            <div style=" height: 10px; position: relative; text-align: center; font-size: 12px; font-family: Source Han Sans CN; font-weight: 300; color:#40597e " >
              1.选择文件上传背景图；<br>2.选择合适的主题色；<br>3.导出效果图，并复制色号修改模板的style；
            
            </div>
          </div>
        </p>

        <div style="left:12.5px; position: relative; font-size: 12px; color:#ff0000">*当前使用浅色主题 </div>

        <!--导出范围-->
        <div id="export-img" style=" left:12.5px; position: relative; width: 375px; height: 600px; background:var(--color5) " >
          
          <div id="bg-img" style="width: 375px; height: 600px; ">
            <div style="width: 375px; height: 600px; background: linear-gradient(to bottom, transparent 150px, var(--color5)); ">
              <div style="width: 357px; height: 511.5px; left: 9.50px; top: 70px; position: relative; background: var(--color4); border-radius: 5.50px">
                
                <div style="width: 355px; height: 510px; left: 1px; top: 1px; position: absolute; background: var(--color5); border-radius: 5px">

                  <!--奖励icon模块-->
                  <div style="width: 355px; height: 104px; left: 0px; top: 380px; position: absolute">
                    <div style="width: 80px; height: 104px; left: 32.50px; top: 0px; position: absolute; background:var(--color2); border-radius: 5px; overflow: hidden">
                      <div style="width: 80px; height: 24px; left: 0px; top: 80px; position: absolute; background:var(--color1)">
                        <div style="left: 6.50px; top: 3px; position: absolute; color: white; font-size: 12px; font-family: Source Han Sans CN; font-weight: 400; word-wrap: break-word">千里传音×1</div>
                      </div>
                    </div>
                    <div style="width: 80px; height: 104px; left: 137.50px; top: 0px; position: absolute; background:var(--color2); border-radius: 5px; overflow: hidden">
                      <div style="width: 80px; height: 24px; left: 0px; top: 80px; position: absolute; background:var(--color1)">
                        <div style="left: 6.50px; top: 3px; position: absolute; color: white; font-size: 12px; font-family: Source Han Sans CN; font-weight: 400; word-wrap: break-word">千里传音×1</div>
                      </div>
                    </div>
                    <div style="width: 80px; height: 104px; left: 242.50px; top: 0px; position: absolute; background:var(--color2); border-radius: 5px; overflow: hidden">
                      <div style="width: 80px; height: 24px; left: 0px; top: 80px; position: absolute; background:var(--color1)">
                        <div style="left: 6.50px; top: 3px; position: absolute; color: white; font-size: 12px; font-family: Source Han Sans CN; font-weight: 400; word-wrap: break-word">千里传音×1</div>
                      </div>
                    </div>
                  </div>

                  <!--二级标题2-->
                  <div style="width: 355px; height: 22.50px; left: 0px; top: 248px; position: absolute">
                    <div style="width: 4.50px; height: 12px; left: 8px; top: 5.50px; position: absolute; background: var(--color4); border-radius: 6px"></div>
                    <div style="left: 22.50px; top: 0px; position: absolute; color: var(--color4); font-size: 15px; font-family: Source Han Sans CN; font-weight: 700; word-wrap: break-word">完成所有任务</div>
                  </div>

                  <!--示意段落-->
                  <div style="width: 355px; height: 112px; left: 0px; top: 276px; position: absolute">
                    <div style="width: 6px; height: 107.50px; left: 7px; top: 0px; position: absolute">
                      <div style="width: 6px; height: 6px; left: 0px; top: 6px; position: absolute; border-radius: 9999px; border: 1px var(--color4) solid"></div>
                      <div style="width: 6px; height: 6px; left: 0px; top: 23.50px; position: absolute; border-radius: 9999px; border: 1px var(--color4) solid"></div>
                    
                    </div><!--段落开头符号-->
                    <div style="width: 315.50px; height: 112px; left: 22.50px; top: 0px; position: absolute">
                      <div style="left: 0px; top: 56px; position: absolute; color: var(--color4); font-size: 12px; font-family: Source Han Sans CN; font-weight: 400; word-wrap: break-word">策划提供文案策划提供文案策划提供文案
                        <br/>策划提供文案策划提供文案策划提供文案策划提供文案策划
                      </div>
                      <div style="width: 315.50px; height: 81.50px; left: 0px; top: 0px; position: absolute; color: white; font-size: 12px; font-family: Source Han Sans CN; font-weight: 400; word-wrap: break-word">策划提供文案策划提供文案策划提供文案
                      <br/>策划提供文案策划提供文案策划提供文案策划提供文案策划<br/>提供文案策划提供文案
                      </div>
                    </div>
                  </div>

                  <!--表格-->
                  <div style="width: 355px; height: 142px; left: 0px; top: 96px; position: absolute">
                    <div style="width: 327px; height: 141px; left: 21px; top: 0px; position: absolute; background:var(--color1); border-radius: 5px; overflow: hidden">

                      <div style="width: 325px; height: 34px; left: 1px; top: 106.5px; position: absolute">
                        <div style="width: 162px; height: 34px; left: 0px; top: 0px; position: absolute; border-radius: 0px 0px 0px 4px; background:var(--color2)">
                          <div style="left: 43px; top: 8px; position: absolute; color: white; font-size: 12px; font-family: Source Han Sans CN; font-weight: 400; word-wrap: break-word">任务名称名称</div>
                        </div>
                        <div style="width: 162px; height: 34px; left: 163px; top: 0px; position: absolute;border-radius: 0px 0px 4px 0px; background:var(--color2)">
                          <div style="left: 49px; top: 8px; position: absolute; color: white; font-size: 12px; font-family: Source Han Sans CN; font-weight: 400; word-wrap: break-word">奖励名称名称</div>
                        </div>
                      </div>

                      <div style="width: 325px; height: 34px; left: 1px; top: 72px; position: absolute">
                        <div style="width: 162px; height: 34px; left: 0px; top: 0px; position: absolute; background:var(--color2)">
                          <div style="left: 43px; top: 7.50px; position: absolute; color: white; font-size: 12px; font-family: Source Han Sans CN; font-weight: 400; word-wrap: break-word">任务名称名称</div>
                        </div>
                        <div style="width: 162px; height: 34px; left: 163px; top: 0px; position: absolute; background:var(--color2)">
                          <div style="left: 49px; top: 7.50px; position: absolute; color: white; font-size: 12px; font-family: Source Han Sans CN; font-weight: 400; word-wrap: break-word">奖励名称名称</div>
                        </div>
                      </div>

                      <div style="width: 325px; height: 34px; left: 1px; top: 37px; position: absolute">
                        <div style="width: 162px; height: 34px; left: 0px; top: 0px; position: absolute; background:var(--color2)">
                          <div style="left: 43.50px; top: 6.50px; position: absolute; color: white; font-size: 12px; font-family: Source Han Sans CN; font-weight: 400; word-wrap: break-word">任务名称名称</div>
                        </div>
                        <div style="width: 162px; height: 34px; left: 163px; top: 0px; position: absolute; background:var(--color2)">
                          <div style="left: 48.50px; top: 6.50px; position: absolute; color: white; font-size: 12px; font-family: Source Han Sans CN; font-weight: 400; word-wrap: break-word">奖励名称名称</div>
                        </div>
                      </div>

                      <div style="width: 325px; height: 34px; left: 1px; top: 1.50px; position: absolute">
                        <div style="width: 24px; height: 18px; left: 235.50px; top: 5.50px; position: absolute">
                          <div style="left: 0px; top: 0px; position: absolute; text-align: center; color: white; font-size: 12px; font-family: Source Han Sans CN; font-weight: 400; word-wrap: break-word">奖励</div>
                        </div>
                        <div style="width: 24px; height: 18px; left: 67.50px; top: 5.50px; position: absolute">
                          <div style="left: 0px; top: 0px; position: absolute; text-align: center; color: white; font-size: 12px; font-family: Source Han Sans CN; font-weight: 400; word-wrap: break-word">任务</div>
                        </div>
                      </div>
                      
                    </div>
                  </div>

                  <!--二级标题1-->
                  <div style="width: 355px; height: 22.50px; left: 0px; top: 64px; position: absolute">
                    <div style="width: 4.50px; height: 12px; left: 8px; top: 5px; position: absolute; background: var(--color4); border-radius: 6px"></div>
                    <div style="left: 22.50px; top: 0px; position: absolute; color: var(--color4); font-size: 15px; font-family: Source Han Sans CN; font-weight: 700; word-wrap: break-word">做任务应援主播（每日重置）</div>
                  </div>

                  <!--一级标题-->
                  <div style="width: 355px; height: 25px; left: 0px; top: 20px; position: absolute">
                    <div style="width: 100px; height: 25px; left: 127.50px; top: 0px; position: absolute; background:var(--color1); border-radius: 12.50px"></div>
                    <div style="left: 145.50px; top: 0.50px; position: absolute; text-align: center; color: white; font-size: 16px; font-family: Source Han Sans CN; font-weight: 700; word-wrap: break-word">规则说明</div>
                  </div>
                </div>  
                </div>
             </div>  
          </div>
        </div>

        <div style="width: 375px; height: 80px; top: 10px; left:12.5px; display: flex; position: relative ">
          <!--上传背景图-->
          <div style="width: 200px; height: 80px; top: 10px;display: flex; justify-content: space-between; position: relative">
            <input type="file" id="imageInput" >
          </div>

          <!--颜色选择和预览-->
          <div style="width: 120px; height: 80px; top: 10px; left:54px; display: flex; justify-content: space-between; position: relative">
          <!--
            <div style="width: 40px; height: 50px; display: flex; flex-direction: column; justify-content: center">
              <div class="color-box color-1 "></div>
              <div class="text-1">color1</div>
            </div>
            <div style="width: 40px; height: 50px; display: flex; flex-direction: column; justify-content: center">
              <div class="color-box color-2 "></div>
              <div class="text-1">color2</div>
            </div>
            <div style="width: 40px; height: 50px; display: flex; flex-direction: column; justify-content: center">
              <div class="color-box color-3 "></div>
              <div class="text-1">color3</div>
            </div>
            <div style="width: 40px; height: 50px; display: flex; flex-direction: column; justify-content: center">
              <div class="color-box color-4 "></div>
              <div class="text-1">color4</div>
            </div>
            <div style="width: 40px; height: 50px; display: flex; flex-direction: column; justify-content: center">
              <div class="color-box color-5 "></div>
              <div class="text-1">color5</div>
            </div>
          --> 
            <input type="text" id="colorValue" value="#646464" style="width:80px; height:26px; border-radius: 4px; ">
            <input type="color" value="#646464" id="colorPicker" class="color-box" onchange="updateColorValue()"><!--主题色选择-->
          </div>

        </div>

        <div style="width: 375px; height: 40px;  left:12.5px; display: flex; position: relative ">
          <button  onclick="exportimg()" class="button">导出</button>
          <div style="left:12px; display: flex; position: relative ">
            <!--<button onclick="location.reload()" class="button2">重置</button>-->
            <button onclick="reload()" class="button2">重置</button>
          </div>
        </div>

        
      </div>   
      
      


<script>
  //const colorPicker = document.getElementById('colorPicker');
//colorPicker.addEventListener('input', function() {
  //document.documentElement.style.setProperty('--color5', colorPicker.value);});
  
const colorPicker = document.getElementById('colorPicker');
const root = document.documentElement;

colorPicker.addEventListener('input', function() {
  const color = colorPicker.value;
  const hsl = rgbToHsl(hexToRgb(color));
  
  root.style.setProperty('--color5', `hsl(${hsl.h}, ${hsl.s}%, ${hsl.l}%)`);
  root.style.setProperty('--color1', `hsl(${hsl.h}, ${hsl.s * 1.13 }%, ${hsl.l - 9}%)`);
  root.style.setProperty('--color2', `hsl(${hsl.h}, ${hsl.s}%, ${hsl.l + 12}%)`);
  root.style.setProperty('--color4', `hsl(${hsl.h}, ${hsl.s - 21 }%, ${hsl.l + 26}%)`);
});

// 将16进制颜色值转换为RGB值
function hexToRgb(hex) {
  const r = parseInt(hex.slice(1, 3), 16);
  const g = parseInt(hex.slice(3, 5), 16);
  const b = parseInt(hex.slice(5, 7), 16);
  
  return { r, g, b };
}

// 将RGB值转换为HSL值
function rgbToHsl(rgb) {
  const r = rgb.r / 255;
  const g = rgb.g / 255;
  const b = rgb.b / 255;
  
  const max = Math.max(r, g, b);
  const min = Math.min(r, g, b);
  
  let h, s, l = (max + min) / 2;
  
  if (max === min) {
    h = s = 0; // achromatic
  } else {
    const d = max - min;
    s = l > 0.5 ? d / (2 - max - min) : d / (max + min);
    
    switch (max) {
      case r:
        h = (g - b) / d + (g < b ? 6 : 0);
        break;
      case g:
        h = (b - r) / d + 2;
        break;
      case b:
        h = (r - g) / d + 4;
        break;
    }
    
    h /= 6;
  }
  
  return { h: Math.round(h * 360), s: Math.round(s * 100), l: Math.round(l * 100) };
}

//显示色值
function updateColorValue() {
        var colorPicker = document.getElementById("colorPicker");
        var colorValue = document.getElementById("colorValue");
        colorValue.value = colorPicker.value;
    }

//上传背景图
const uploadInput = document.getElementById('imageInput');
const myDiv = document.getElementById('bg-img');

uploadInput.addEventListener('change', function() {
  const file = this.files[0];
  const reader = new FileReader();

  reader.onload = function(e) {
    myDiv.style.backgroundImage = `url(${e.target.result})`;
  };

  reader.readAsDataURL(file);
});


//导出预览图
function exportimg() {
            html2canvas(document.getElementById("export-img"),{scale: 2}).then(function(canvas) {
                var link = document.createElement('a');
                link.href = canvas.toDataURL();
                link.download = 'screenshot.png';
                link.click();
            });
        }

//重置
function reload(){
  document.documentElement.style.setProperty('--color5','hsl(0,0%,39%)');
  document.documentElement.style.setProperty('--color1','hsl(0,0%,30%)');
  document.documentElement.style.setProperty('--color2','hsl(0,0%,42%');
  document.documentElement.style.setProperty('--color4','hsl(0,0%,65%)');
  document.getElementById("imageInput").value = "";

  colorPicker.value = "#646464";
  colorValue.value = "#646464";

  var bgElement = document.getElementById("bg-img");
  bgElement.style.backgroundImage = 'url(https://raw.githubusercontent.com/YNYU01/Mini-Act-Tools/main/img/bg_%E8%A7%84%E5%88%99%E9%A1%B5.png)';

}

</script>
  </body>
</html>
